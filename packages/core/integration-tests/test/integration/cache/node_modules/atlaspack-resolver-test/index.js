const {Resolver} = require('@atlaspack/plugin');
const path = require('path');

module.exports = new Resolver({
  async loadConfig({config}) {
    let res = await config.getConfig(['.resolverrc']);
    return res?.contents;
  },
  resolve({dependency, options, config}) {
    let resolveFrom = dependency.resolveFrom ? path.dirname(dependency.resolveFrom) : options.projectRoot;
    let specifier = dependency.specifier !== 'foo' ? dependency.specifier : dependency.specifier + '.js';
    return {
      filePath: path.resolve(resolveFrom, config?.[dependency.specifier] ?? specifier)
    }
  }
});
